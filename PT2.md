# 第二次笔记
## Verilog表达式
### 表达式
Verilog表达式由操作符和操作数构成,目的是根据操作符的意义得到一个运算结果
表达式可以在出现数值的任何地方使用
例如
```verilog
a^b;                //a与b进行异或操作
address[9:0]+10'b1; //地址累加
flag1 && flag2;     //逻辑与操作
```
### 操作数
操作数可以是任意的数据类型某些定的语法结构要求使用特定数据类型的操作数
例如
```verilog
module test

//实数
real a,b,c;
c=a+b;

//寄存器
reg [3:0]   cprmu_1,cprmu2;
always@(posedge clk) begin;
        cprmu_2=cprmu1^cprmu2;
end

//函数
reg flag1;
flag =calculate_result(A,B);

//非法操作数
reg [3:0]   res;
wire[3:0]   temp;
always@(*) begin
    res=cprmu_2-cprmu1_1;
    //temp=cprmu_2-cprmu1_1;//不合法,always块里赋值对象不能是wire型
end
endmodule
```
### 操作符
Verilog提供了大约9种操作符,分别是算数,关系,等价,逻辑,按位,归约,移位,拼接,条件操作符
<u>大部分操作符与C语言中类似</u>
不同操作符优先级是不同的,下表列出了优先级从高到低的排列顺序
| **操作符** | **操作符号**         | **优先级** |
|---------|------------------|---------|
| 单目运算    | \+ \- ！~         | 最高      |
| 乘,除,取模  | \* / %           |         |
| 加减      | \+ \-            |         |
| 移位      | <<    >>         |         |
| 关系      | < <= > >=        |         |
| 等价      | == \!= === \!=== |         |
| 归约      | & ~&             |         |
|         | ^ ~^             |         |
|         | \| ~\|           |         |
| 逻辑      | &&               |         |
|         | \|\|             |         |
| 条件      | ? :              | 最低      |

#### 算术操作符
<u>算术操作符的使用方式和C语言基本相同</u>

```verilog
reg [3:0] a,b;
reg [4:0] c;
a=4'b0010;      //a的值为2
b=4'b1001;      //b的值为9
c=a+b;          //结果为c=b'1011
c=b/a;          //结果为c=4,取整
```
<u>如果操作数某一位为X,计算结果会**全部出现X**</u>

例如
```verilog
b=4'b100x;
c=a+b;          //结果为c=4'bxxxx
```
对变量进行声名时,要根据实际情况对变量的位宽进行合理的声名
要避免因为位宽不够导致的结果溢出,溢出时,高位将被截断
比如说,在使用无符号乘法时,结果变量的位宽应该是两个乘数变量的位宽和
例如
```verilog
reg [3:0]   mula;
reg [1:0]   mulb;
reg [5:0]   res;
mula=4'he;
mulb=2'h3;
res=mula*mulb;  //结果为res=6'h2a,结果没有丢失位数 
```
加号(+)和减号(-)也可以作为单目运算符使用,用来表示操作符的正负性,此类操作符优先级最高
负数表示时,可以直接在十进制数字前面加一个减号,也可以指定位宽,因为负数使用二进制补码表示
不指定位宽来表示负数,编译器会自动分配位宽,造成意想不到的结果
例如
```verilog
mula=-4'd4;
mulb=2;
res=mula*mulb;      //计算结果为res=-6'd8,即res=6'h38,正常
res=mula*(-'d4);    //(结果会异常)
```
#### 关系操作符
关系操作符就是判断大小的四种符号
关系操作符的正常结果有两种,1和0
在Verilog中特殊的是:<u>如果操作数字中有一位为x或z,则关系表达式的结果为x</u>

#### 等价操作符
等价操作符包括
    
    逻辑相等    ==
    逻辑不等    !=
    全等        ===
    非全等      !==
等价操作符的正常结果有两种,1和0
逻辑相等/不等操作不能比较x或z,当操作数包含一个x或z,则结果为不确定值
全等比较时,<u>如果按位比较有相同的x或z,返回结果也可以为1,即全等比较也可以比较x或z</u>
所以全等比较的结果一定不包含x
例如
```verilog
A=4;
B=8'h04;
C=4'bxxxx;
D=4'hx;
A==B;       //为真
A==(B+1);   //为假
A==C;       //为X不确定
A===C;      //为假,返回值为0
C===D;      //为真,返回值为1 
```
#### 逻辑操作符